<!-- formationsEntreprise.html -->
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Formations par Cat√©gorie</title>
</head>
<body>

  <a href="pageEntreprise.html">‚Üê Retour</a>
  <h1>Nos Formations</h1>

  <div id="formationContent">
    <!-- Formations will be injected here -->
  </div>

   <script>
    const urlParams = new URLSearchParams(window.location.search);
    const cat = urlParams.get("cat");


    console.log("‚úÖ Script charg√© !");
    console.log("Param√®tre brut :", window.location.search);


    // Prevent loading if 'cat' is missing
    if (!cat) {
      document.getElementById("formationContent").innerHTML =
        "<p>‚ùó Veuillez acc√©der √† cette page depuis la liste des cat√©gories.</p>";
      throw new Error("‚ùå Param√®tre 'cat' manquant dans l'URL");
    }

    console.log("üîç URL param 'cat' =", cat);

    fetch('data/data.json') // ‚úÖ correct path
      .then(res => {
        if (!res.ok) throw new Error("Erreur HTTP " + res.status);
        return res.json();
      })
      .then(data => {
        console.log("‚úÖ JSON loaded");
        console.log("üì¶ Full data:", data);
        const category = data[cat];
        console.log("üîç Trying to access data[cat]:", category);

        const contentDiv = document.getElementById("formationContent");

        if (!category || !category.formations || category.formations.length === 0) {
          contentDiv.innerHTML = `<p>Aucune formation trouv√©e pour cette cat√©gorie.</p>`;
          return;
        }

        const header = document.createElement("div");
        header.innerHTML = `
          <h2>${category.title}</h2>
          <p>${category.description}</p>
        `;
        contentDiv.appendChild(header);

        category.formations.forEach((formation) => {
          const card = document.createElement("div");
          card.classList.add("formation-card");
          card.innerHTML = `
            <h3>${formation.title}</h3>
            <p>${formation.description}</p>
          `;
          contentDiv.appendChild(card);
        });
      })
      .catch(error => {
        console.error("‚ùå Erreur lors du chargement des donn√©es :", error);
        document.getElementById("formationContent").innerHTML =
          "<p>Une erreur s'est produite lors du chargement des donn√©es.</p>";
      });
  </script>  
</body>
</html>